import{bn as h,bh as U}from"./index-b2e15df3.js";import{h as C,J as S,r as v,a3 as i,j as b,v as y,x as e,D as o,B as n,ah as I,ai as P,l as B,ag as L,ad as q,k as F,y as g,u as R}from"./_plugin-vue_export-helper-33be20d1.js";import{u as A}from"./useHandleData-fc19fefe.js";import"./IconifyIcon-a624bcfa.js";function E(u){return h.get(`/admin/activity/couponInfo/${u.pageNum}/${u.pageSize}`)}function z(u){return h.delete(`/admin/activity/couponInfo/remove/${u}`)}const H=u=>(I("data-v-1b649129"),u=u(),P(),u),j=H(()=>B("div",{class:"info"},"填写每个用户可以领取多少张",-1)),J=C({name:"UserDrawer"}),M=C({...J,setup(u,{expose:k}){const w=S({couponName:[{required:!0,message:"请填写优惠券名称"},{min:2,message:"用户名不能小于2位"}],password:[{required:!0,message:"请填写用户密码"},{min:6,message:"密码不能小于6位"}]}),c=v(!1),l=v({title:""}),s=v(!1),D=r=>{l.value=r,c.value=!0},t=v(),_=()=>{t.value.validate(async r=>{if(r)try{s.value=!0,U.success({message:`${l.value.title}用户成功！`}),l.value.getTableList(),c.value=!1,s.value=!1}catch(a){s.value=!1,console.log(a)}})};return k({acceptParams:D}),(r,a)=>{const f=i("el-input"),p=i("el-form-item"),m=i("el-radio"),x=i("el-radio-group"),V=i("el-input-number"),N=i("el-form"),T=i("el-button"),$=i("el-drawer");return b(),y($,{modelValue:c.value,"onUpdate:modelValue":a[4]||(a[4]=d=>c.value=d),"destroy-on-close":!0,size:"450px",title:`${l.value.title}优惠券`},{footer:e(()=>[o(T,{onClick:a[3]||(a[3]=d=>c.value=!1)},{default:e(()=>[n("取消")]),_:1}),o(T,{type:"primary",onClick:_,loading:s.value},{default:e(()=>[n(" 确定 ")]),_:1},8,["loading"])]),default:e(()=>[o(N,{ref_key:"ruleFormRef",ref:t,"label-width":"110px","label-suffix":" :",rules:w,model:l.value.rowData},{default:e(()=>[o(p,{label:"优惠券名称",prop:"couponName"},{default:e(()=>[o(f,{modelValue:l.value.rowData.couponName,"onUpdate:modelValue":a[0]||(a[0]=d=>l.value.rowData.couponName=d),placeholder:"请填写优惠券名称",clearable:""},null,8,["modelValue"])]),_:1}),o(p,{label:"优惠券类型",prop:"couponType"},{default:e(()=>[o(x,{modelValue:l.value.rowData.couponType,"onUpdate:modelValue":a[1]||(a[1]=d=>l.value.rowData.couponType=d)},{default:e(()=>[o(m,{label:3},{default:e(()=>[n("现金券")]),_:1}),o(m,{label:6},{default:e(()=>[n("折扣券")]),_:1}),o(m,{label:9},{default:e(()=>[n("满减券")]),_:1}),o(m,{label:9},{default:e(()=>[n("满量打折券")]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(p,{label:"用户领取数量",prop:"limitNum"},{default:e(()=>[o(V,{modelValue:l.value.rowData.limitNum,"onUpdate:modelValue":a[2]||(a[2]=d=>l.value.rowData.limitNum=d),min:1,max:100},null,8,["modelValue"]),j]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}});const G=L(M,[["__scopeId","data-v-1b649129"]]),X=C({__name:"index",setup(u){const k=[{type:"index",label:"#",width:80},{prop:"id",label:"id"},{prop:"couponName",label:"优惠券名称",width:100},{prop:"couponTypeString",label:"优惠券类型",width:100},{prop:"rangeTypeString",label:"范围类型",width:100},{prop:"activityTypeString",label:"规则",render:({row:t})=>o("div",null,[n("减金额"),t.benefitAmount])},{prop:"limitNum",label:"用户领取数量",width:110},{prop:"startTime",label:"开始时间",sortable:!0,width:110},{prop:"endTime",label:"结束时间",sortable:!0,width:110},{prop:"expireTime",label:"过期时间",sortable:!0,width:110},{prop:"operation",label:"操作",fixed:"right",width:280}],w=v(),c=t=>({list:t==null?void 0:t.records,total:t==null?void 0:t.total}),l=v(),s=async(t,_={})=>{let r={title:t,rowData:{..._},api:"",getTableList:w.value.getTableList};l.value.acceptParams(r)},D=async t=>{await A(z,t.id,`删除${t.couponName}用户`),w.value.getTableList()};return(t,_)=>{const r=i("el-button"),a=i("ProTable"),f=q("auth");return b(),F("div",null,[o(a,{ref_key:"proTable",ref:w,dataCallback:c,columns:k,requestApi:R(E)},{tableHeader:e(()=>[g((b(),y(r,{type:"primary",icon:"Plus",onClick:_[0]||(_[0]=p=>s("新增"))},{default:e(()=>[n(" 添加 ")]),_:1})),[[f,["btn.User.add"]]])]),operation:e(p=>[g((b(),y(r,{type:"primary",link:"",icon:"UserFilled",onClick:m=>s("分配角色",p.row)},{default:e(()=>[n(" 规则 ")]),_:2},1032,["onClick"])),[[f,["btn.User.assgin"]]]),g((b(),y(r,{type:"primary",link:"",icon:"Edit",onClick:m=>s("编辑",p.row)},{default:e(()=>[n(" 编辑 ")]),_:2},1032,["onClick"])),[[f,["btn.User.update"]]]),g((b(),y(r,{type:"danger",link:"",icon:"Delete",onClick:m=>D(p.row)},{default:e(()=>[n(" 删除 ")]),_:2},1032,["onClick"])),[[f,"btn.User.remove"]])]),_:1},8,["requestApi"]),o(G,{ref_key:"drawerRef",ref:l},null,512)])}}});export{X as default};
