import{bn as R,bh as D}from"./index-b2e15df3.js";import{h as C,J as x,r as p,a3 as v,j as _,v as y,x as l,D as m,B as d,ad as $,k as L,y as w,u as P}from"./_plugin-vue_export-helper-33be20d1.js";function U(b){return R.get(`/admin/activity/activityInfo/${b.pageNum}/${b.pageSize}`)}const V=C({name:"UserDrawer"}),q=C({...V,setup(b,{expose:k}){const g=x({username:[{required:!0,message:"请填写用户姓名"},{min:4,message:"用户名不能小于4位"}],password:[{required:!0,message:"请填写用户密码"},{min:6,message:"密码不能小于6位"}]}),i=p(!1),a=p({title:""}),o=p(!1),c=x({allRolesList:[],assignRoles:[],checkAll:!1,isIndeterminate:!1}),e=s=>{if(s.title==="分配角色"){const{list:t}=s;c.allRolesList=t.data.allRolesList,c.assignRoles=t.data.assignRoles.map(n=>n.roleId),c.isIndeterminate=c.assignRoles.length>0}a.value=s,i.value=!0},u=p(),r=()=>{u.value.validate(async s=>{if(s)try{o.value=!0,D.success({message:`${a.value.title}用户成功！`}),a.value.getTableList(),i.value=!1,o.value=!1}catch(t){o.value=!1,console.log(t)}})};return k({acceptParams:e}),(s,t)=>{const n=v("el-form"),f=v("el-button"),T=v("el-drawer");return _(),y(T,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=h=>i.value=h),"destroy-on-close":!0,size:"450px",title:`${a.value.title}活动`},{footer:l(()=>[m(f,{onClick:t[0]||(t[0]=h=>i.value=!1)},{default:l(()=>[d("取消")]),_:1}),m(f,{type:"primary",onClick:r,loading:o.value},{default:l(()=>[d(" 确定 ")]),_:1},8,["loading"])]),default:l(()=>[m(n,{ref_key:"ruleFormRef",ref:u,"label-width":"100px","label-suffix":" :",rules:g,model:a.value.rowData},null,8,["rules","model"])]),_:1},8,["modelValue","title"])}}}),I=C({__name:"index",setup(b){const k=[{type:"index",label:"#",width:80},{prop:"id",label:"id"},{prop:"activityName",label:"活动名称"},{prop:"activityDesc",label:"活动m描述"},{prop:"activityTypeString",label:"活动类型"},{prop:"startTime",label:"开始时间",sortable:!0},{prop:"endTime",label:"结束时间",sortable:!0},{prop:"createTime",label:"创建时间",sortable:!0},{prop:"operation",label:"操作",fixed:"right",width:280}],g=p(),i=e=>({list:e==null?void 0:e.records,total:e==null?void 0:e.total}),a=p(),o=async(e,u={})=>{let r={title:e,rowData:{...u},api:"",getTableList:g.value.getTableList};a.value.acceptParams(r)},c=e=>{console.log(e)};return(e,u)=>{const r=v("el-button"),s=v("ProTable"),t=$("auth");return _(),L("div",null,[m(s,{ref_key:"proTable",ref:g,dataCallback:i,columns:k,requestApi:P(U)},{tableHeader:l(()=>[m(r,{type:"primary",icon:"Plus",onClick:u[0]||(u[0]=n=>o("新增"))},{default:l(()=>[d(" 添加 ")]),_:1})]),operation:l(n=>[w((_(),y(r,{type:"primary",link:"",icon:"UserFilled",onClick:f=>o("分配角色",n.row)},{default:l(()=>[d(" 分配规则 ")]),_:2},1032,["onClick"])),[[t,["btn.User.assgin"]]]),w((_(),y(r,{type:"primary",link:"",icon:"Edit",onClick:f=>o("编辑",n.row)},{default:l(()=>[d(" 编辑 ")]),_:2},1032,["onClick"])),[[t,["btn.User.update"]]]),w((_(),y(r,{type:"danger",link:"",icon:"Delete",onClick:f=>c(n.row)},{default:l(()=>[d(" 删除 ")]),_:2},1032,["onClick"])),[[t,"btn.User.remove"]])]),_:1},8,["requestApi"]),m(q,{ref_key:"drawerRef",ref:a},null,512)])}}});export{I as default};
