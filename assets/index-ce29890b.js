import{u as R}from"./useHandleData-fc19fefe.js";import{bn as w,bh as D}from"./index-b2e15df3.js";import{h as T,J as A,r as m,a3 as s,j as k,v as C,x as e,D as a,B as v,k as N,ah as S,ai as B,l as q,ag as F,u as G,F as I}from"./plugin-vue_export-helper-33be20d1.js";import"./IconifyIcon-a624bcfa.js";function j(l){return w.get(`/admin/product/baseTrademark/${l.pageNum}/${l.pageSize}`)}function z(l){return w.delete(`/admin/product/baseTrademark/remove/${l}`)}function E(l){return w.post("/admin/product/baseTrademark/save",l)}function J(l){return w.post("/admin/product/baseTrademark/update",l)}const M=l=>(S("data-v-dc6aa9de"),l=l(),B(),l),H=["src"],K=M(()=>q("div",{class:"el-upload__tip"},"只能上传jpg/png文件，且不超过50kb",-1)),O=T({name:"UserDrawer"}),Q=T({...O,setup(l,{expose:y}){const _=A({tmName:[{required:!0,message:"请填写品牌名称"},{min:2,message:"用户名不能小于2位"}],logoUrl:[{required:!0,message:"请上传品牌Logo"}]}),c=m(!1),r=m({title:""}),i=m(!1),g=n=>{r.value=n,c.value=!0},t=(n,o)=>{console.log(n,o),r.value.rowData.logoUrl=n.data},d=n=>{const o=["image/jpeg","image/png"].indexOf(n.type)>=0,p=n.size/1024<50;return o||D.error("上传头像图片只能是 JPG/PNG 格式!"),p||D.error("上传头像图片大小不能超过 50K!"),o&&p},u=m(),f=()=>{u.value.validate(async n=>{if(n)try{i.value=!0,await r.value.api(r.value.rowData),D.success({message:`${r.value.title}品牌成功！`}),r.value.getTableList(),c.value=!1,i.value=!1}catch(o){i.value=!1,console.log(o)}})};return y({acceptParams:g}),(n,o)=>{const p=s("el-input"),h=s("el-form-item"),P=s("Plus"),U=s("el-icon"),$=s("el-upload"),V=s("el-form"),x=s("el-button"),L=s("el-drawer");return k(),C(L,{modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=b=>c.value=b),"destroy-on-close":!0,size:"450px",title:`${r.value.title}用户`},{footer:e(()=>[a(x,{onClick:o[1]||(o[1]=b=>c.value=!1)},{default:e(()=>[v("取消")]),_:1}),a(x,{type:"primary",onClick:f,loading:i.value},{default:e(()=>[v(" 确定 ")]),_:1},8,["loading"])]),default:e(()=>[a(V,{ref_key:"ruleFormRef",ref:u,"label-width":"100px","label-suffix":" :",rules:_,model:r.value.rowData},{default:e(()=>[a(h,{label:"品牌名称",prop:"tmName"},{default:e(()=>[a(p,{modelValue:r.value.rowData.tmName,"onUpdate:modelValue":o[0]||(o[0]=b=>r.value.rowData.tmName=b),placeholder:"请填写品牌名称",clearable:""},null,8,["modelValue"])]),_:1}),a(h,{label:"品牌Logo",prop:"logoUrl"},{default:e(()=>[a($,{class:"avatar-uploader",action:"dev-api/admin/product/fileUpload","show-file-list":!1,"on-success":t,"before-upload":d},{tip:e(()=>[K]),default:e(()=>[r.value.rowData.logoUrl?(k(),N("img",{key:0,src:r.value.rowData.logoUrl,class:"avatar"},null,8,H)):(k(),C(U,{key:1,class:"avatar-uploader-icon"},{default:e(()=>[a(P)]),_:1}))]),_:1})]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue","title"])}}});const W=F(Q,[["__scopeId","data-v-dc6aa9de"]]),ae=T({__name:"index",setup(l){const y=[{prop:"id",label:"id"},{prop:"tmName",label:"品牌名称"},{prop:"logoUrl",label:"Logo",render:({row:t})=>a(I,null,[a(s("el-image"),{src:t.logoUrl,style:"height: 100px; width: 100px;",fit:"cover"},null)])},{prop:"updateTime",label:"更新时间",sortable:!0},{prop:"operation",label:"操作",fixed:"right",width:280}],_=m(),c=t=>({list:t==null?void 0:t.records,total:t==null?void 0:t.total}),r=async t=>{await R(z,t.id,`删除${t.tmName}角色`),_.value.getTableList()},i=m(),g=async(t,d={})=>{const u={title:t,rowData:{...d},api:t==="新增"?E:J,getTableList:_.value.getTableList};i.value.acceptParams(u)};return(t,d)=>{const u=s("el-button"),f=s("Auth"),n=s("ProTable");return k(),N("div",null,[a(n,{ref_key:"proTable",ref:_,columns:y,requestApi:G(j),dataCallback:c},{tableHeader:e(()=>[a(f,{value:["btn.Role.add"]},{default:e(()=>[a(u,{type:"primary",icon:"Plus",onClick:d[0]||(d[0]=o=>g("新增"))},{default:e(()=>[v(" 添加 ")]),_:1})]),_:1},8,["value"])]),operation:e(o=>[a(f,{value:["btn.Role.update"]},{default:e(()=>[a(u,{type:"primary",link:"",icon:"Edit",onClick:p=>g("修改",o.row)},{default:e(()=>[v(" 编辑 ")]),_:2},1032,["onClick"])]),_:2},1032,["value"]),a(f,{value:["btn.Role.remove"]},{default:e(()=>[a(u,{type:"primary",link:"",icon:"Delete",onClick:p=>r(o.row)},{default:e(()=>[v(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1032,["value"])]),_:1},8,["requestApi"]),a(W,{ref_key:"DrawerRef",ref:i},null,512)])}}});export{ae as default};
